<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Covariance and correlation | Gezi's TechBlog</title> <meta name="author" content="Gezi "/> <meta name="description" content="A personal technlog :). "/> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"/> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"/> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="none" id="highlight_theme_light"/> <link rel="shortcut icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üïä</text></svg>"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://gezi81889.github.io/blog/2022/Cov-and-Corr/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"/> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/">Gezi's TechBlog</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog<span class="sr-only">(current)</span></a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">Repositories</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Covariance and correlation</h1> <p class="post-meta">August 12, 2022</p> <p class="post-tags"> <a href="/blog/2022"> <i class="fas fa-calendar fa-sm"></i> 2022 </a> ¬† ¬∑ ¬† <a href="/blog/tag/math"> <i class="fas fa-hashtag fa-sm"></i> math</a> ¬† <a href="/blog/tag/covariance"> <i class="fas fa-hashtag fa-sm"></i> covariance</a> ¬† <a href="/blog/tag/correlation"> <i class="fas fa-hashtag fa-sm"></i> correlation</a> ¬† ¬† ¬∑ ¬† <a href="/blog/category/math-notes"> <i class="fas fa-tag fa-sm"></i> math-notes</a> ¬† </p> </header> <article class="post-content"> <h3 id="variance-vs-covariance">Variance vs. Covariance</h3> <p>Variance refers to the spread of a variable around its mean value, while a covariance refers to the measure of the directional relationship between two random variables.</p> <p>Suppose we have a dataset with variable \(X\) and \(Y\). For a variable \(X\), it has n values \([x_1,x_2...x_n]\) ,</p> \[Var(X)= \frac{1}{n-1}\sum(x_i-\overline x)^2\] <p>For another variable \(Y\) in this dataset, we can also calculate its variance. But \(Var(X)\) and \(Var(Y)\) don‚Äôt give us information about the distribution of the data in 2D space, meaning the trend of data in higher space. The covariance quantifies the <strong>direction of the trend</strong>, but it does not say how strong the trend is and covariance is very <strong>sensitive to scaling</strong>.</p> \[Cov(X,Y) = \frac{1}{n-1}\sum(x_i-\overline x)(y_i-\overline y)=E[(X-E(X))(Y-E(Y))]=E(XY)-E(X)E(Y)\] <p>For a positive covariance, \(X\) and \(Y\) are incrasing together; For a negative value, \(X\) is increasing but \(Y\) is decreasing.</p> <h3 id="correlation">Correlation</h3> <p>Correlation between two variables measures the <strong>strength of the trend</strong>. After normalization, correlation coefficient does not get affected by scaling. Both covariance and correlation are used for quantifying the ‚ÄúIndependence‚Äù between ramdon variables.</p> \[Cor(X,Y) = \frac{Cor(X,Y)}{\sqrt{Var(X)Var(Y)}}\] <h3 id="covariance-matrix">Covariance matrix</h3> <p>Covariance matrix contain variances and covariance between variables in our data, which means we have variables in both column and row. Suppose we have \(p\) cells \(\times\) \(n\) genes in dataset \(X\) and \(q\) cells \(\times\) \(m\) genes in dataset \(Y\) (Note that \(X\) and \(Y\) are now datasets not variables ):</p> \[X=\begin {pmatrix} x_{11} &amp; x_{12} &amp; ... &amp; x_{1n} \\ x_{21} &amp; x_{22} &amp; ... &amp; x_{2n} \\ . &amp; . &amp; ... &amp; . \\ . &amp; . &amp; ... &amp; . \\ x_{p1} &amp; x_{p2} &amp; ... &amp; x_{pn} \end{pmatrix} = [\vec x_1,\vec x_2,...\vec x_p]‚Äô\] \[Y=\begin {pmatrix} y_{11} &amp; y_{12} &amp; ... &amp; y_{1n} \\ y_{21} &amp; y_{22} &amp; ... &amp; y_{2n} \\ . &amp; . &amp; ... &amp; . \\ . &amp; . &amp; ... &amp; . \\ y_{q1} &amp; y_{q2} &amp; ... &amp; y_{qn} \end{pmatrix} = [\vec y_1,\vec y_2,...\vec y_q]‚Äô\] <p>Mean-centered (each column has zero expectation):</p> \[\begin{align*}\label{1} \overline x &amp;=\frac{1}{p}\sum_{i=1}^p \vec x_{i} = [E(gene_1),E(gene_2),...E(gene_n)] \\ \widetilde X &amp;=[\vec x_1-\overline x,\vec x_2-\overline x,...\vec x_p-\overline x]'=[gene_1-E(gene_1),gene_2-E(gene_2),....gene_n-E(gene_n)] \\ \overline y &amp;=\frac{1}{q}\sum_{i=1}^q \vec y_{i}= [E(gene_1),E(gene_2),...E(gene_m)] \\ \widetilde Y &amp;=[\vec y_1-\overline y,\vec y_2-\overline y,...\vec y_q-\overline y]'=[gene_1-E(gene_1),gene_2-E(gene_2),....gene_m-E(gene_m)] \end{align*}\] <p>Covariance matrix is the matrix whose $(i,j)$ entry is the covariance between the variables $gene_i, gene_j$:</p> \[\begin{align*}\label{2} Var(\vec X)_{i,j} &amp;= Cov(gene_i, gene_j)=&gt;Var(\vec X)= Cov(\vec X,\vec X)=\frac{1}{p-1}\widetilde X^T\widetilde X \\ Var(\vec Y)_{i,j} &amp;=Cov(gene_i, gene_j)=&gt;Var(\vec Y)=Cov(\vec Y,\vec Y) = \frac{1}{q-1}\widetilde Y^T\widetilde Y \end{align*}\] <p>If we denote the variable vector as \(\vec X=[gene_1,gene_2,...gene_n]'\) (sometime also called random vectors), the covariance matrix of dataset \(X\) can also be considered as covariance matrix of the random vector \(\vec X\) , which is typically denoted by \(K_{XX}\) or \(\Sigma_{XX}\) .</p> <p><strong><em>Characteristics of Covariance matrix \(A=Var(\vec X)\):</em></strong></p> <ol> <li> <p>\(n \times n\) Square symmetric -&gt; \(A = A^T\)</p> </li> <li> <p>\(Var(\vec X)_{ii}=Cov(gene_i,gene_i)=Var(gene_i)\).</p> </li> <li> <p>Positive semi-definite -&gt; For every non-zero vector \(\vec z\), \(z'Az‚â•0\)</p> </li> <li> <p>If \(gene_1,gene_2,....gene_n\) are all independent,\(Var(\vec X)=diag(Var(gene_1),Var(gene_2),...Var(gene_n))\)</p> </li> </ol> <p>Similarly we can also have \(K_{XY}\) or \(\Sigma_{XY}\) , which is the <strong>cross-covariance matrix</strong> of random vector \(\vec X\) and \(\vec Y\) of dataset \(X\) and \(Y\). \((i,j)\) entry is the covariance between the variables \(gene_i\) from dataset \(X\) and \(gene_j\) from dataset \(Y\) (note that for calculation, we have to subset two datasets to make them have same observations/cells \(r\)):</p> \[Cov(\vec X,\vec Y)_{i,j} =Cov(gene_i, gene_j)=&gt;Cov(\vec X,\vec Y)= \frac{1}{r-1}\widetilde X^T\widetilde Y\] <p>Cross-covariance can measure how dependent two variable set of two datasets are, but it also depends on the unit of \(\vec X\) and \(\vec Y\), that is to say, they are also sensitive to scaling.</p> <p><strong><em>Characteristics of Cross-coariance matrix \(A=Cov(\vec X, \vec Y), B=Cov(\vec Y,\vec X)^T\):</em></strong></p> <ol> <li>\(n \times m\) matrix, in general not symmetric</li> <li>\(A= B^T\).</li> <li>\(Cov(\vec X_1+\vec X_2,\vec Y)=Cov(\vec X_1,\vec Y)+Cov(\vec X_2,\vec Y)\).</li> <li>If \(a\) is a constant, \(Cov(a\vec X,\vec Y)=Cov(\vec X,a\vec Y)=aA\) ; \(Cov(a+\vec X,\vec Y)=Cov(\vec X,a +\vec Y)=A\) (Linear recombination is discussed below)</li> <li>If \(n=m\), \(Var(\vec X+\vec Y)=Var(\vec X)+Var(\vec Y)+A+B\)</li> </ol> <h3 id="covariance-of-linear-recombinations">Covariance of linear recombinations</h3> <p>If constants \(a_i,b_i \in R\) , \(i=1,2,...,n\) , then the following is true:</p> \[\begin{align*}\label{3} &amp; Cov(a_1gene_1+a_2gene_2+....+a_ngene_n,b_1gene1+b_2gene2+...+b_ngene_n) \\ &amp; =Cov(\vec a \cdot \vec X, \vec b \cdot \vec X) = \sum_{i=1}^n\sum_{j=1}^n a_ib_jCov(gene_i,gene_j)=\vec a^T\Sigma_{XX}\vec b \end{align*}\] <p>\(\vec a=[a_1,a_2,...a_n]', \vec b=[b_1,b_2,...b_n]'\). Similarly,</p> \[\begin{align*}\label{4} &amp; Cov(a_1gene_1+a_2gene_2+....+a_ngene_n,a_1gene1+a_2gene2+...+a_ngene_n) \\ &amp; =Cov(\vec a \cdot \vec X, \vec a \cdot \vec X) = Var(\vec a \cdot \vec X)= \sum_{i=1}^n\sum_{j=1}^n a_ia_jCov(gene_i,gene_j)=\vec a^TVar(\vec X)\vec a \end{align*}\] <p>Recalled \(Var(aX)=a^2Var(X)\), \(X\) is a random variable.</p> <p>For a square \(n \times n\) matrix \(A=[\vec a_1',\vec a_2',...\vec a_n']'\) and a square \(n \times n\) matrix \(B=[\vec b_1',\vec b_2',...\vec b_n']'\), \(A\vec X\) is the vector of linear recombination of \(X_i\) variables, we have:</p> \[Var(A\vec X)= AVar(\vec X)A^T \\ Cor(A\vec X,B\vec X) = AVar(\vec X)B^T\] <p>In summary, for ramdon vectors \(\vec X\) and \(\vec Y\), \(\vec X=[X_1,X_2,...X_n], \vec Y=[Y_1,Y_2,...Y_m]\) , \(X_i\) and \(Y_i\) are random variables (In our cases above, gene variable).</p> <ol> <li> <p>\(Cov(X_i,X_i)=Var(X_i)\) is a value</p> </li> <li> <p>\(Cov(\vec X,\vec X)=Var(\vec X)=K_{XX}=\Sigma_{XX}\) is covariance matrix</p> </li> <li> <p>\(Cov(X_i,Y_i)\) is a value</p> </li> <li> <p>\(Cov(\vec X,\vec Y)=K_{XY}=\Sigma_{XY}\) is covariance matrix</p> </li> <li> <p>\(Cov(\vec a^T \vec X,\vec b^T \vec X)= Cov(X^*,X^*)\) is a value. \(X^*\) is the linear recombination of variable \(X_i\) ; Similarly, \(Cov(\vec a^T \vec X,\vec b^T \vec Y)\) is a value</p> </li> </ol> <h3 id="correlation-matrix">Correlation matrix</h3> <p>Correlation matrix contain correlations between variables in our data, which means we have variables in both column and row.\((i,j)\) entry is the correlation between the variables \(gene_i, gene_j\):</p> <p>Standardized matrix:</p> \[\begin{align*}\label{5} \sigma(gene_i) &amp;=\sqrt{Var(gene_i)} \\ X_s &amp;=[\frac{gene_1-E(gene_1)}{\sigma(gene_1)},\frac{gene_2-E(gene_2)}{\sigma(gene_2)},....\frac{gene_n-E(gene_n)}{\sigma(gene_n)}] \\ Y_s &amp;=[\frac{gene_1-E(gene_1)}{\sigma(gene_1)},\frac{gene_2-E(gene_2)}{\sigma(gene_2)},....\frac{gene_n-E(gene_m)}{\sigma(gene_m)}] \end{align*}\] <p>Correlation matrix:</p> \[\begin{align*}\label{6} &amp;Corr(\vec X)_{ij}=Cor(gene_i,gene_j)-&gt;Corr(\vec X)=\frac{1}{p-1}X_s^TX_s \\ &amp;Corr(\vec Y)_{ij}=Cor(gene_i,gene_j)-&gt;Corr(\vec Y)=\frac{1}{q-1}Y_s^TY_s \end{align*}\] <p>Similarly, we also have <strong>Cross-correlation</strong>. Similarly we need to subset the dataset to make them have same observations/cells \(r\).</p> \[\begin{align*}\label{7} Corr(\vec X,\vec Y)_{ij} &amp;=Cor(gene_i,gene_j)-&gt; Corr(\vec X,\vec Y)=\frac{1}{r-1}X^T_sY_s \\ Corr(\vec Y,\vec X)_{ij} &amp;=Cor(gene_i,gene_j)-&gt; Corr(\vec Y,\vec X)=\frac{1}{r-1}Y^T_sX_s \end{align*}\] <h3 id="reference">Reference</h3> <p>This blog heavily referenced the Course of Youtuber molypath.</p> <p><a href="https://www.youtube.com/watch?v=QptKkD__k-c" target="_blank" rel="noopener noreferrer">https://www.youtube.com/watch?v=QptKkD__k-c</a></p> </article><div id="disqus_thread"></div> <script type="text/javascript">var disqus_shortname="gezi81889-1",disqus_identifier="/blog/2022/Cov-and-Corr",disqus_title="Covariance and correlation";!function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="//"+disqus_shortname+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)}();</script> <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript" target="_blank" rel="noopener noreferrer">comments powered by Disqus.</a> </noscript> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> ¬© Copyright 2023 Gezi . Powered by <a href="https://jekyllrb.com/" target="_blank" rel="noopener noreferrer">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" target="_blank" rel="noopener noreferrer">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="noopener noreferrer">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="noopener noreferrer">Unsplash</a>. Last updated: December 08, 2023. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="/assets/js/common.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> </body> </html>